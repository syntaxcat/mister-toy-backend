var O=Object.defineProperty;var B=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var A=(e,t,n)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,S=(e,t)=>{for(var n in t||(t={}))P.call(t,n)&&A(e,n,t[n]);if(B)for(var n of B(t))N.call(t,n)&&A(e,n,t[n]);return e};import{a as v,R as q,b as M,c as u,d as r,e as _,w as $,f as p,g as I,F as w,h as y,r as g,o as d,t as f,i as j,j as c,v as T,k as x,l as H,m as C,n as L,C as J,p as K,D as W,q as z,s as G,u as Q,x as X}from"./vendor.e76851ec.js";const Y=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};Y();const U={saveToStorage:Z,loadFromStorage:tt,makeId:ot,removeFromStorage:et};function Z(e,t){localStorage.setItem(e,JSON.stringify(t)||null)}function tt(e){let t=localStorage.getItem(e);return t?JSON.parse(t):void 0}function et(e){localStorage.removeItem(e)}function ot(e=8){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=0;l<e;l++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}const D={getLoggedinUser:nt};function nt(){return U.loadFromStorage("loggedinUser")}const F={login:st,logout:it},rt="/api/auth";async function st(e){const n=(await v.post(`${rt}/login`,e)).data;return U.saveToStorage("loggedinUser",n),n}async function it(){return U.removeFromStorage("loggedinUser"),Promise.resolve()}var m=(e,t)=>{const n=e.__vccOpts||e;for(const[l,o]of t)n[l]=o;return n};const lt={components:{RouterLink:q,RouterView:M},created(){this.$store.dispatch({type:"updateLoggedInUser",user:D.getLoggedinUser()||null})},methods:{logout(){F.logout().then(()=>{this.$router.push({name:"login-page"})})}},computed:{loggedInUser(){return this.$store.getters.loggedInUser}}},at={class:"app-header"},dt=r("span",{class:"logo"},"\u{1F381}ToyStore\u{1F9F8}",-1),ut={key:0},ct=y("Toys"),yt=y(" | "),pt=y("Dashboard"),mt=y(" | "),ht=y("Login");function _t(e,t,n,l,o,s){const i=g("RouterLink"),k=g("RouterView");return d(),u(w,null,[r("header",at,[dt,r("nav",null,[s.loggedInUser?(d(),u("div",ut,[_(i,{to:"/toyApp"},{default:$(()=>[ct]),_:1}),yt,_(i,{to:"/dashboard"},{default:$(()=>[pt]),_:1}),mt,r("button",{onClick:t[0]||(t[0]=(...a)=>s.logout&&s.logout(...a))},"logout")])):p("",!0),s.loggedInUser?p("",!0):(d(),I(i,{key:1,to:"/login-page"},{default:$(()=>[ht]),_:1}))])]),_(k)],64)}var gt=m(lt,[["render",_t]]);const b="/api/toy",h={query:ft,remove:vt,save:Tt,getById:kt,getEmptyToy:St};function ft(){return v.get(b).then(e=>e.data)}function vt(e){return v.delete(b+e)}function Tt(e){return e._id?v.put(b+e._id,e):v.post(b,e)}function kt(e){return v.get(b+e).then(t=>t.data)}function St(){return{_id:"",name:"",price:"",type:"",createdAt:"",inStock:!0,labels:["Doll","Battery Powered","Baby"]}}const $t={props:{toy:{type:Object,required:!0}},methods:{},components:{}},bt={class:"toy-preview"},It=r("hr",null,null,-1),Ut=r("span",null,"Price:",-1),Et=r("span",null,"inStock:",-1);function Bt(e,t,n,l,o,s){return d(),u("section",bt,[r("h3",null,f(n.toy.name),1),It,r("h3",null,[Ut,y(f(n.toy.price),1)]),r("h3",null,[Et,y(f(n.toy.inStock),1)])])}var At=m($t,[["render",Bt]]);const xt={data(){return{toy:null}},created(){this.loadToy()},computed:{toyId(){return this.$route.params.toyId}},methods:{loadToy(){h.getById(this.toyId).then(e=>{this.toy=e})}},watch:{toyId:{handler(){this.loadToy()},immediate:!0}}},wt={key:0,class:"toy-details"},Ct=r("h1",null,"Details",-1);function Lt(e,t,n,l,o,s){return o.toy?(d(),u("section",wt,[Ct,y(" "+f(o.toy.name)+" "+f(o.toy.price)+" "+f(o.toy.type)+" "+f(o.toy.inStock),1)])):p("",!0)}var V=m(xt,[["render",Lt]]);const Dt={props:{toys:{type:Array,required:!0},user:{type:Object,required:!0}},data(){return{isAdmin:this.user.isAdmin}},methods:{removeToy(e){this.$emit("removeToy",e)}},components:{toyPreview:At,toyDetails:V}},Ft={key:0,class:"toy-list"},Vt={class:"actions"},Rt=y("Edit"),Ot=y("Details"),Pt=["onClick"];function Nt(e,t,n,l,o,s){const i=g("toyPreview"),k=g("router-link");return n.toys?(d(),u("section",Ft,[r("ul",null,[(d(!0),u(w,null,j(n.toys,a=>(d(),u("li",{key:a._id},[_(i,{toy:a},null,8,["toy"]),r("div",Vt,[o.isAdmin?(d(),I(k,{key:0,to:"/edit/"+a._id},{default:$(()=>[Rt]),_:2},1032,["to"])):p("",!0),_(k,{to:"/details/"+a._id},{default:$(()=>[Ot]),_:2},1032,["to"]),o.isAdmin?(d(),u("button",{key:1,onClick:De=>s.removeToy(a._id)},"Delete",8,Pt)):p("",!0)])]))),128))])])):p("",!0)}var qt=m(Dt,[["render",Nt]]);const Mt={data(){return{filterBy:{inStock:null,name:""}}},methods:{filter(){this.$emit("filterBy",S({},this.filterBy))}}},jt={class:"toy-filter"},Ht=r("h1",null,"Filter",-1),Jt=y("Out of stock "),Kt=y("In stock ");function Wt(e,t,n,l,o,s){return d(),u("section",jt,[Ht,c(r("input",{type:"text",placeholder:"Search by name",onInput:t[0]||(t[0]=(...i)=>s.filter&&s.filter(...i)),"onUpdate:modelValue":t[1]||(t[1]=i=>o.filterBy.name=i)},null,544),[[T,o.filterBy.name]]),r("label",null,[c(r("input",{type:"radio",onChange:t[2]||(t[2]=(...i)=>s.filter&&s.filter(...i)),"onUpdate:modelValue":t[3]||(t[3]=i=>o.filterBy.inStock=i),value:""},null,544),[[x,o.filterBy.inStock]]),Jt]),r("label",null,[c(r("input",{type:"radio",onChange:t[4]||(t[4]=(...i)=>s.filter&&s.filter(...i)),"onUpdate:modelValue":t[5]||(t[5]=i=>o.filterBy.inStock=i),value:"true"},null,544),[[x,o.filterBy.inStock]]),Kt])])}var zt=m(Mt,[["render",Wt]]);const Gt={data(){return{emptyToy:h.getEmptyToy()}},computed:{toys(){return this.$store.getters.toysForDisplay},user(){return this.$store.getters.loggedInUser}},created(){this.$store.dispatch({type:"loadToys"})},methods:{removeToy(e){this.$store.dispatch({type:"removeToy",id:e})},addToy(){this.$store.dispatch({type:"addToy",toy:S({},this.emptyToy)}).then(()=>{this.emptyToy=h.getEmptyToy()})},filter(e){this.$store.dispatch({type:"filter",filterBy:e})}},components:{toyList:qt,toyFilter:zt}},Qt={key:0,class:"toy-app"},Xt=r("h1",null,"Toy App",-1),Yt=r("hr",null,null,-1),Zt=r("option",{disabled:"",value:""},"Type",-1),te=r("option",{value:"Funny"},"Funny",-1),ee=r("option",{value:"Adult"},"Adult",-1),oe=r("option",{value:"Educational"},"Educational",-1),ne=[Zt,te,ee,oe],re=r("label",{for:"inStock"},"inStock",-1),se=r("button",{type:"submit"},"Add",-1),ie=r("hr",null,null,-1);function le(e,t,n,l,o,s){const i=g("toyFilter"),k=g("toyList");return s.toys?(d(),u("section",Qt,[Xt,_(i,{onFilterBy:s.filter},null,8,["onFilterBy"]),Yt,r("form",{onSubmit:t[4]||(t[4]=L((...a)=>s.addToy&&s.addToy(...a),["prevent"]))},[c(r("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o.emptyToy.name=a),placeholder:"Enter name"},null,512),[[T,o.emptyToy.name]]),c(r("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=a=>o.emptyToy.price=a),placeholder:"Enter price"},null,512),[[T,o.emptyToy.price]]),c(r("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.emptyToy.type=a)},ne,512),[[H,o.emptyToy.type]]),re,c(r("input",{id:"inStock",type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=a=>o.emptyToy.inStock=a)},null,512),[[C,o.emptyToy.inStock]]),se],32),ie,_(k,{toys:s.toys,user:s.user,onRemoveToy:s.removeToy},null,8,["toys","user","onRemoveToy"])])):p("",!0)}var ae=m(Gt,[["render",le]]);const de={data(){return{toyToEdit:null}},created(){this.loadToy()},computed:{toyId(){return this.$route.params.toyId}},methods:{loadToy(){h.getById(this.toyId).then(e=>{this.toyToEdit=S({},e)})},save(){this.$store.dispatch({type:"save",toy:S({},this.toyToEdit)})}},watch:{toyId:{handler(){this.loadToy()},immediate:!0}}},ue={key:0,class:"toy-edit"},ce=r("h1",null,"Edit",-1),ye=r("button",{type:"submit"},"Save",-1);function pe(e,t,n,l,o,s){return o.toyToEdit?(d(),u("section",ue,[ce,r("form",{onSubmit:t[3]||(t[3]=L((...i)=>s.save&&s.save(...i),["prevent"]))},[c(r("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>o.toyToEdit.name=i)},null,512),[[T,o.toyToEdit.name]]),c(r("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=i=>o.toyToEdit.price=i)},null,512),[[T,o.toyToEdit.price]]),c(r("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=i=>o.toyToEdit.isStock=i)},null,512),[[C,o.toyToEdit.isStock]]),ye],32)])):p("",!0)}var me=m(de,[["render",pe]]);J.register(...K);const he={name:"Home",props:{toys:{type:Array,required:!0}},data(){return{chartData:null}},created(){const e=this.toys.reduce((n,l)=>(l.type in n?n[l.type]++:n[l.type]=1,n),{});console.log(e);const t=Object.keys(e);this.chartData={labels:t,datasets:[{data:t.map(n=>e[n]),backgroundColor:["#77CEFF","#0079AF","#123E6B","#97B0C4","#A5C8ED"]}]}},components:{DoughnutChart:W}};function _e(e,t,n,l,o,s){const i=g("DoughnutChart");return o.chartData!==null?(d(),I(i,{key:0,chartData:o.chartData},null,8,["chartData"])):p("",!0)}var ge=m(he,[["render",_e]]);const fe={created(){this.$store.dispatch({type:"loadToys"})},computed:{toys(){return this.$store.getters.getAllToys}},methods:{},watch:{},components:{chart:ge}},ve={key:0,class:"dashboard"},Te=r("h1",null,"Dashboard",-1);function ke(e,t,n,l,o,s){const i=g("chart");return s.toys.length>0?(d(),u("section",ve,[Te,_(i,{toys:s.toys},null,8,["toys"])])):p("",!0)}var Se=m(fe,[["render",ke]]);const $e={data(){return{loginCredentials:{username:"",password:""}}},methods:{login(){F.login(this.loginCredentials).then(e=>{this.$store.dispatch({type:"updateLoggedInUser",user:e}),this.$router.push({name:"toyApp"})}).catch(e=>{console.log("Error after login",e)})}}},be={class:"login-signup-container"},Ie=r("h1",null,"Login",-1),Ue=r("label",{for:"username"},"Enter username:",-1),Ee=r("label",{for:"password"},"Password",-1),Be=r("button",{type:"submit"},"Login",-1);function Ae(e,t,n,l,o,s){return d(),u("section",be,[Ie,r("form",{onSubmit:t[2]||(t[2]=(...i)=>s.login&&s.login(...i)),class:"login"},[Ue,c(r("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=i=>o.loginCredentials.username=i)},null,512),[[T,o.loginCredentials.username]]),Ee,c(r("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=i=>o.loginCredentials.password=i)},null,512),[[T,o.loginCredentials.password]]),Be],32)])}var xe=m($e,[["render",Ae]]);const R=z({history:G(),routes:[{path:"/toyApp",name:"toyApp",component:ae},{path:"/details/:toyId",name:"toyDetails",component:V},{path:"/edit/:toyId",name:"toyEdit",component:me},{path:"/dashboard",name:"dashboard",component:Se},{path:"/login-page",name:"login-page",component:xe}]});R.beforeEach(async e=>{const t=D.getLoggedinUser();if(!t&&e.name!=="login-page")return{name:"login-page"};if(t&&e.name==="login-page")return{name:"toyApp"};if(e.name==="toyEdit"&&!t.isAdmin)return{name:"toyApp"}});var we={state:{toys:[],filterBy:{inStock:null,name:""}},getters:{toysForDisplay(e){var t=e.toys;if(e.filterBy.inStock!==null){const n=e.filterBy.inStock==="true";t=e.toys.filter(l=>l.inStock===n)}if(e.filterBy.name){const n=new RegExp(e.filterBy.name,"i");t=t.filter(l=>n.test(l.name))}return t},getAllToys(e){return e.toys}},mutations:{setToys(e,{toys:t}){e.toys=t},removeToy(e,{id:t}){const n=e.toys.findIndex(l=>l._id===t);e.toys.splice(n,1)},addToy(e,{savedToy:t}){e.toys.unshift(t)},setFilter(e,{filterBy:t}){e.filterBy=t}},actions:{removeToy({commit:e},{id:t}){return h.remove(t).then(()=>{e({type:"removeToy",id:t})})},loadToys({commit:e}){return h.query().then(t=>{e({type:"setToys",toys:t})})},save({commit:e},{toy:t}){return h.save(t)},addToy({commit:e},{toy:t}){return h.save(t).then(n=>{e({type:"addToy",savedToy:n.data})})},filter({commit:e},{filterBy:t}){e({type:"setFilter",filterBy:t})}}},Ce={state:{loggedInUser:null},getters:{loggedInUser(e){return e.loggedInUser}},mutations:{setLoggedInUser(e,{user:t}){e.loggedInUser=t}},actions:{updateLoggedInUser({commit:e},{user:t}){e({type:"setLoggedInUser",user:t})}}};const Le=Q({strict:!0,state:{},getters:{},mutations:{},actions:{},modules:{toyStore:we,userStore:Ce}});v.defaults.withCredentials=!0;const E=X(gt);E.use(R);E.use(Le);E.mount("#app");
